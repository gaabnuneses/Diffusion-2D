import numpy as np
import matplotlib.pyplot as plt

nmalhas = [50,200,450,800,1800,3200,5000,8450,12800]
#Q1
tmax_Q1 = [1525.8437244255028, 1525.8537957101942, 1525.856376153769, 1525.8607518081812, 1525.8615710169206, 1525.8617220955164, 1525.861736387517, 1525.8606686512023, 1525.861661317116]
tmin_Q1 = [1504.5702684354324, 1504.5260933442137, 1504.5526912355858, 1504.540411561663, 1504.545044340059, 1504.547150626678, 1504.5483128734445, 1504.5502189530994, 1504.5498651285614]
#Q2
tmax_Q2 = [1525.8671727871006, 1525.8628186987212, 1525.8621589606998, 1525.8619030544241, 1525.8616842743932, 1525.8615880342925, 1525.861534863685, 1525.861489290715, 1525.861462783115]
tmin_Q2 = [1504.5491577218618, 1504.5506357040758, 1504.5510273351624, 1504.551202084442, 1504.5513598967227, 1504.5514309589978, 1504.5514704550396, 1504.551504394742, 1504.5515241364646]

erroQ1 = []
erroQ2 = []
for i in range(len(tmax_Q1)):
    erroQ1.append(np.abs(tmax_Q1[i]-tmax_Q2[len(tmax_Q2)-1])/tmax_Q2[len(tmax_Q2)-1])
    erroQ2.append(np.abs(tmax_Q2[i]-tmax_Q2[len(tmax_Q2)-1])/tmax_Q2[len(tmax_Q2)-1])
plt.figure()
plt.plot(nmalhas,erroQ1,marker='o',label="Q1")
plt.plot(nmalhas,erroQ2,marker='o',label="Q2")
plt.xticks(nmalhas[4:])
plt.xlabel("Número de Elementos")
plt.ylabel("Diferença absoluta relativa com o mais refinado")
#plt.yscale('log')
plt.xscale('log')
plt.title("Valor máximo do Campo de Temperatura")
plt.legend()
plt.show()